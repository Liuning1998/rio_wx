function priceTos (price) {
  if (price == null) {return ''}
  price = parseFloat(price)
  return price.toFixed(2)
}

function priceDecimal (price) {
  if (price == null) { return '' }
  price = parseFloat(price)
  var priceStr = price.toFixed(2)
  var length = priceStr.length
  return priceStr.slice(length - 2, length)
}

function priceInt (price) {
  if (price == null) { return '' }
  price = parseFloat(price)
  var priceStr = price.toFixed(2)
  var length = priceStr.length
  return priceStr.slice(0, length-3)
}

// lineItems 购物车中已勾选的商品
function discountTotal (storeCart, lineItems, user=null, shipmentExpenses=0) {
  if (user == null) { return storeCart.total }
  if (user.kzx_user_identification == 1 && user.discount != null) {
    var result = 0
    for(var i=0; i < lineItems.length; i++) {
      var item = lineItems[i]
      var item_total = item.price * item.quantity * user.discount
      item_total = Math.round(item_total * 100)/100

      result = result + item_total
    }
    result = result + shipmentExpenses * 0.98

    return Math.round(result * 100)/100
  } else {
    return storeCart.total + shipmentExpenses
  }
}

module.exports = {
  tos: priceTos,
  int: priceInt,
  decimal: priceDecimal,
  discountTotal: discountTotal
}